
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="An easy-to-use library for implementing various multi-object tracking algorithms.">
      
      
        <meta name="author" content="syahvan">
      
      
        <link rel="canonical" href="https://Hirai-Labs.github.io/supertracker/bytetrack/">
      
      
        <link rel="prev" href="../examples/intro/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>Bytetrack Module - supertracker</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.d7758b05.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Google+Sans:300,300i,400,400i,700,700i%7CRegular:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Google Sans";--md-code-font:"Regular"}</style>
      
    
    
      <link rel="stylesheet" href="../css/timeago.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#bytetrack-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="supertracker" class="md-header__button md-logo" aria-label="supertracker" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            supertracker
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Bytetrack Module
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Hirai-Labs/supertracker" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="supertracker" class="md-nav__button md-logo" aria-label="supertracker" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    supertracker
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Hirai-Labs/supertracker" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/Hirai-Labs/supertracker/issues" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Report Issues
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Bytetrack Module
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Bytetrack Module
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#supertracker.bytetrack" class="md-nav__link">
    <span class="md-ellipsis">
      supertracker.bytetrack
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core" class="md-nav__link">
    <span class="md-ellipsis">
      core
    </span>
  </a>
  
    <nav class="md-nav" aria-label="core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core.ByteTrack" class="md-nav__link">
    <span class="md-ellipsis">
      ByteTrack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ByteTrack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core.ByteTrack.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core.ByteTrack.update_with_detections" class="md-nav__link">
    <span class="md-ellipsis">
      update_with_detections()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core.ByteTrack.update_with_tensors" class="md-nav__link">
    <span class="md-ellipsis">
      update_with_tensors()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core.joint_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      joint_tracks()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core.sub_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      sub_tracks()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter" class="md-nav__link">
    <span class="md-ellipsis">
      kalman_filter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kalman_filter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter.KalmanFilter" class="md-nav__link">
    <span class="md-ellipsis">
      KalmanFilter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KalmanFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.initiate" class="md-nav__link">
    <span class="md-ellipsis">
      initiate()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.multi_predict" class="md-nav__link">
    <span class="md-ellipsis">
      multi_predict()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.project" class="md-nav__link">
    <span class="md-ellipsis">
      project()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.update" class="md-nav__link">
    <span class="md-ellipsis">
      update()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track" class="md-nav__link">
    <span class="md-ellipsis">
      single_object_track
    </span>
  </a>
  
    <nav class="md-nav" aria-label="single_object_track">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track.STrack" class="md-nav__link">
    <span class="md-ellipsis">
      STrack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="STrack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track.STrack.tlbr" class="md-nav__link">
    <span class="md-ellipsis">
      tlbr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track.STrack.tlwh" class="md-nav__link">
    <span class="md-ellipsis">
      tlwh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track.STrack.activate" class="md-nav__link">
    <span class="md-ellipsis">
      activate()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track.STrack.tlwh_to_xyah" class="md-nav__link">
    <span class="md-ellipsis">
      tlwh_to_xyah()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track.STrack.update" class="md-nav__link">
    <span class="md-ellipsis">
      update()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#supertracker.bytetrack" class="md-nav__link">
    <span class="md-ellipsis">
      supertracker.bytetrack
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core" class="md-nav__link">
    <span class="md-ellipsis">
      core
    </span>
  </a>
  
    <nav class="md-nav" aria-label="core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core.ByteTrack" class="md-nav__link">
    <span class="md-ellipsis">
      ByteTrack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ByteTrack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core.ByteTrack.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core.ByteTrack.update_with_detections" class="md-nav__link">
    <span class="md-ellipsis">
      update_with_detections()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core.ByteTrack.update_with_tensors" class="md-nav__link">
    <span class="md-ellipsis">
      update_with_tensors()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core.joint_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      joint_tracks()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.core.sub_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      sub_tracks()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter" class="md-nav__link">
    <span class="md-ellipsis">
      kalman_filter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kalman_filter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter.KalmanFilter" class="md-nav__link">
    <span class="md-ellipsis">
      KalmanFilter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KalmanFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.initiate" class="md-nav__link">
    <span class="md-ellipsis">
      initiate()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.multi_predict" class="md-nav__link">
    <span class="md-ellipsis">
      multi_predict()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.project" class="md-nav__link">
    <span class="md-ellipsis">
      project()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.update" class="md-nav__link">
    <span class="md-ellipsis">
      update()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track" class="md-nav__link">
    <span class="md-ellipsis">
      single_object_track
    </span>
  </a>
  
    <nav class="md-nav" aria-label="single_object_track">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track.STrack" class="md-nav__link">
    <span class="md-ellipsis">
      STrack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="STrack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track.STrack.tlbr" class="md-nav__link">
    <span class="md-ellipsis">
      tlbr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track.STrack.tlwh" class="md-nav__link">
    <span class="md-ellipsis">
      tlwh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track.STrack.activate" class="md-nav__link">
    <span class="md-ellipsis">
      activate()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track.STrack.tlwh_to_xyah" class="md-nav__link">
    <span class="md-ellipsis">
      tlwh_to_xyah()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supertracker.bytetrack.single_object_track.STrack.update" class="md-nav__link">
    <span class="md-ellipsis">
      update()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                



                  


  
  


<h1 id="bytetrack-module">Bytetrack module<a class="headerlink" href="#bytetrack-module" title="Permanent link">&para;</a></h1>


  <div class="doc doc-object doc-module">

<a id="supertracker.bytetrack"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">










  <div class="doc doc-object doc-module">



<h2 id="supertracker.bytetrack.core" class="doc doc-heading">
        <code>core</code>



<a href="#supertracker.bytetrack.core" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="supertracker.bytetrack.core.ByteTrack" class="doc doc-heading">
        <code>
ByteTrack        </code>



<a href="#supertracker.bytetrack.core.ByteTrack" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Initialize the ByteTrack object.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>track_activation_threshold</code></td>
        <td><code>float</code></td>
        <td><p>Detection confidence threshold
for track activation. Increasing track_activation_threshold improves accuracy
and stability but might miss true detections. Decreasing it increases
completeness but risks introducing noise and instability.</p></td>
        <td><code>0.25</code></td>
      </tr>
      <tr>
        <td><code>lost_track_buffer</code></td>
        <td><code>int</code></td>
        <td><p>Number of frames to buffer when a track is lost.
Increasing lost_track_buffer enhances occlusion handling, significantly
reducing the likelihood of track fragmentation or disappearance caused
by brief detection gaps.</p></td>
        <td><code>30</code></td>
      </tr>
      <tr>
        <td><code>minimum_matching_threshold</code></td>
        <td><code>float</code></td>
        <td><p>Threshold for matching tracks with detections.
Increasing minimum_matching_threshold improves accuracy but risks fragmentation.
Decreasing it improves completeness but risks false positives and drift.</p></td>
        <td><code>0.8</code></td>
      </tr>
      <tr>
        <td><code>frame_rate</code></td>
        <td><code>int</code></td>
        <td><p>The frame rate of the video.</p></td>
        <td><code>30</code></td>
      </tr>
      <tr>
        <td><code>minimum_consecutive_frames</code></td>
        <td><code>int</code></td>
        <td><p>Number of consecutive frames that an object must
be tracked before it is considered a 'valid' track.
Increasing minimum_consecutive_frames prevents the creation of accidental tracks from
false detection or double detection, but risks missing shorter tracks.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ByteTrack</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the ByteTrack object.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        track_activation_threshold (float): Detection confidence threshold</span>
<span class="sd">            for track activation. Increasing track_activation_threshold improves accuracy</span>
<span class="sd">            and stability but might miss true detections. Decreasing it increases</span>
<span class="sd">            completeness but risks introducing noise and instability.</span>
<span class="sd">        lost_track_buffer (int): Number of frames to buffer when a track is lost.</span>
<span class="sd">            Increasing lost_track_buffer enhances occlusion handling, significantly</span>
<span class="sd">            reducing the likelihood of track fragmentation or disappearance caused</span>
<span class="sd">            by brief detection gaps.</span>
<span class="sd">        minimum_matching_threshold (float): Threshold for matching tracks with detections.</span>
<span class="sd">            Increasing minimum_matching_threshold improves accuracy but risks fragmentation.</span>
<span class="sd">            Decreasing it improves completeness but risks false positives and drift.</span>
<span class="sd">        frame_rate (int): The frame rate of the video.</span>
<span class="sd">        minimum_consecutive_frames (int): Number of consecutive frames that an object must</span>
<span class="sd">            be tracked before it is considered a &#39;valid&#39; track.</span>
<span class="sd">            Increasing minimum_consecutive_frames prevents the creation of accidental tracks from</span>
<span class="sd">            false detection or double detection, but risks missing shorter tracks.</span>
<span class="sd">    &quot;&quot;&quot;</span> 

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">track_activation_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span>
        <span class="n">lost_track_buffer</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
        <span class="n">minimum_matching_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
        <span class="n">frame_rate</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
        <span class="n">minimum_consecutive_frames</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track_activation_threshold</span> <span class="o">=</span> <span class="n">track_activation_threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minimum_matching_threshold</span> <span class="o">=</span> <span class="n">minimum_matching_threshold</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">det_thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_activation_threshold</span> <span class="o">+</span> <span class="mf">0.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_time_lost</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_rate</span> <span class="o">/</span> <span class="mf">30.0</span> <span class="o">*</span> <span class="n">lost_track_buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minimum_consecutive_frames</span> <span class="o">=</span> <span class="n">minimum_consecutive_frames</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kalman_filter</span> <span class="o">=</span> <span class="n">KalmanFilter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared_kalman</span> <span class="o">=</span> <span class="n">KalmanFilter</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">STrack</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">STrack</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">removed_tracks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">STrack</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Warning, possible bug: If you also set internal_id to start at 1,</span>
        <span class="c1"># all traces will be connected across objects.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">internal_id_counter</span> <span class="o">=</span> <span class="n">IdCounter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span> <span class="o">=</span> <span class="n">IdCounter</span><span class="p">(</span><span class="n">start_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_with_detections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">detections</span><span class="p">:</span> <span class="n">Detections</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Detections</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the tracker with the provided detections and returns the updated</span>
<span class="sd">        detection results.</span>

<span class="sd">        Args:</span>
<span class="sd">            detections (Detections): The detections to pass through the tracker.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tensors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">detections</span><span class="o">.</span><span class="n">xyxy</span><span class="p">,</span>
                <span class="n">detections</span><span class="o">.</span><span class="n">confidence</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">tracks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_with_tensors</span><span class="p">(</span><span class="n">tensors</span><span class="o">=</span><span class="n">tensors</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tracks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">detection_bounding_boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">det</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">det</span> <span class="ow">in</span> <span class="n">tensors</span><span class="p">])</span>
            <span class="n">track_bounding_boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">track</span><span class="o">.</span><span class="n">tlbr</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">tracks</span><span class="p">])</span>

            <span class="n">ious</span> <span class="o">=</span> <span class="n">box_iou_batch</span><span class="p">(</span><span class="n">detection_bounding_boxes</span><span class="p">,</span> <span class="n">track_bounding_boxes</span><span class="p">)</span>

            <span class="n">iou_costs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ious</span>

            <span class="n">matches</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">linear_assignment</span><span class="p">(</span><span class="n">iou_costs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="n">detections</span><span class="o">.</span><span class="n">tracker_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">detections</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i_detection</span><span class="p">,</span> <span class="n">i_track</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
                <span class="n">detections</span><span class="o">.</span><span class="n">tracker_id</span><span class="p">[</span><span class="n">i_detection</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                    <span class="n">tracks</span><span class="p">[</span><span class="n">i_track</span><span class="p">]</span><span class="o">.</span><span class="n">external_track_id</span>
                <span class="p">)</span>

            <span class="k">return</span> <span class="n">detections</span><span class="p">[</span><span class="n">detections</span><span class="o">.</span><span class="n">tracker_id</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">detections</span> <span class="o">=</span> <span class="n">Detections</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>
            <span class="n">detections</span><span class="o">.</span><span class="n">tracker_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">detections</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resets the internal state of the ByteTrack tracker.</span>

<span class="sd">        This method clears the tracking data, including tracked, lost,</span>
<span class="sd">        and removed tracks, as well as resetting the frame counter. It&#39;s</span>
<span class="sd">        particularly useful when processing multiple videos sequentially,</span>
<span class="sd">        ensuring the tracker starts with a clean state for each new video.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">internal_id_counter</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">removed_tracks</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_with_tensors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tensors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">STrack</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the tracker with the provided tensors and returns the updated tracks.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            tensors: The new tensors to update with.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[STrack]: Updated tracks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">activated_starcks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">refind_stracks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lost_stracks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">removed_stracks</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">scores</span> <span class="o">=</span> <span class="n">tensors</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
        <span class="n">bboxes</span> <span class="o">=</span> <span class="n">tensors</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">4</span><span class="p">]</span>

        <span class="n">remain_inds</span> <span class="o">=</span> <span class="n">scores</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_activation_threshold</span>
        <span class="n">inds_low</span> <span class="o">=</span> <span class="n">scores</span> <span class="o">&gt;</span> <span class="mf">0.1</span>
        <span class="n">inds_high</span> <span class="o">=</span> <span class="n">scores</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_activation_threshold</span>

        <span class="n">inds_second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">inds_low</span><span class="p">,</span> <span class="n">inds_high</span><span class="p">)</span>
        <span class="n">dets_second</span> <span class="o">=</span> <span class="n">bboxes</span><span class="p">[</span><span class="n">inds_second</span><span class="p">]</span>
        <span class="n">dets</span> <span class="o">=</span> <span class="n">bboxes</span><span class="p">[</span><span class="n">remain_inds</span><span class="p">]</span>
        <span class="n">scores_keep</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">remain_inds</span><span class="p">]</span>
        <span class="n">scores_second</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">inds_second</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dets</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Detections&quot;&quot;&quot;</span>
            <span class="n">detections</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">STrack</span><span class="p">(</span>
                    <span class="n">STrack</span><span class="o">.</span><span class="n">tlbr_to_tlwh</span><span class="p">(</span><span class="n">tlbr</span><span class="p">),</span>
                    <span class="n">score_keep</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">minimum_consecutive_frames</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">shared_kalman</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">internal_id_counter</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">tlbr</span><span class="p">,</span> <span class="n">score_keep</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dets</span><span class="p">,</span> <span class="n">scores_keep</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">detections</span> <span class="o">=</span> <span class="p">[]</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; Add newly detected tracklets to tracked_stracks&quot;&quot;&quot;</span>
        <span class="n">unconfirmed</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tracked_stracks</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># type: list[STrack]</span>

        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">track</span><span class="o">.</span><span class="n">is_activated</span><span class="p">:</span>
                <span class="n">unconfirmed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tracked_stracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; Step 2: First association, with high score detection boxes&quot;&quot;&quot;</span>
        <span class="n">strack_pool</span> <span class="o">=</span> <span class="n">joint_tracks</span><span class="p">(</span><span class="n">tracked_stracks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span><span class="p">)</span>
        <span class="c1"># Predict the current location with KF</span>
        <span class="n">STrack</span><span class="o">.</span><span class="n">multi_predict</span><span class="p">(</span><span class="n">strack_pool</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_kalman</span><span class="p">)</span>
        <span class="n">dists</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">iou_distance</span><span class="p">(</span><span class="n">strack_pool</span><span class="p">,</span> <span class="n">detections</span><span class="p">)</span>

        <span class="n">dists</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">fuse_score</span><span class="p">(</span><span class="n">dists</span><span class="p">,</span> <span class="n">detections</span><span class="p">)</span>
        <span class="n">matches</span><span class="p">,</span> <span class="n">u_track</span><span class="p">,</span> <span class="n">u_detection</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">linear_assignment</span><span class="p">(</span>
            <span class="n">dists</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minimum_matching_threshold</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">itracked</span><span class="p">,</span> <span class="n">idet</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
            <span class="n">track</span> <span class="o">=</span> <span class="n">strack_pool</span><span class="p">[</span><span class="n">itracked</span><span class="p">]</span>
            <span class="n">det</span> <span class="o">=</span> <span class="n">detections</span><span class="p">[</span><span class="n">idet</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span><span class="p">:</span>
                <span class="n">track</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">detections</span><span class="p">[</span><span class="n">idet</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">)</span>
                <span class="n">activated_starcks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">track</span><span class="o">.</span><span class="n">re_activate</span><span class="p">(</span><span class="n">det</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">)</span>
                <span class="n">refind_stracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; Step 3: Second association, with low score detection boxes&quot;&quot;&quot;</span>
        <span class="c1"># association the untrack to the low score detections</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dets_second</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Detections&quot;&quot;&quot;</span>
            <span class="n">detections_second</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">STrack</span><span class="p">(</span>
                    <span class="n">STrack</span><span class="o">.</span><span class="n">tlbr_to_tlwh</span><span class="p">(</span><span class="n">tlbr</span><span class="p">),</span>
                    <span class="n">score_second</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">minimum_consecutive_frames</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">shared_kalman</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">internal_id_counter</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">tlbr</span><span class="p">,</span> <span class="n">score_second</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dets_second</span><span class="p">,</span> <span class="n">scores_second</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">detections_second</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">r_tracked_stracks</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">strack_pool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u_track</span>
            <span class="k">if</span> <span class="n">strack_pool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span>
        <span class="p">]</span>
        <span class="n">dists</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">iou_distance</span><span class="p">(</span><span class="n">r_tracked_stracks</span><span class="p">,</span> <span class="n">detections_second</span><span class="p">)</span>
        <span class="n">matches</span><span class="p">,</span> <span class="n">u_track</span><span class="p">,</span> <span class="n">u_detection_second</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">linear_assignment</span><span class="p">(</span>
            <span class="n">dists</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mf">0.5</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">itracked</span><span class="p">,</span> <span class="n">idet</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
            <span class="n">track</span> <span class="o">=</span> <span class="n">r_tracked_stracks</span><span class="p">[</span><span class="n">itracked</span><span class="p">]</span>
            <span class="n">det</span> <span class="o">=</span> <span class="n">detections_second</span><span class="p">[</span><span class="n">idet</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span><span class="p">:</span>
                <span class="n">track</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">det</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">)</span>
                <span class="n">activated_starcks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">track</span><span class="o">.</span><span class="n">re_activate</span><span class="p">(</span><span class="n">det</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">)</span>
                <span class="n">refind_stracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">u_track</span><span class="p">:</span>
            <span class="n">track</span> <span class="o">=</span> <span class="n">r_tracked_stracks</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">track</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Lost</span><span class="p">:</span>
                <span class="n">track</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Lost</span>
                <span class="n">lost_stracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deal with unconfirmed tracks, usually tracks with only one beginning frame&quot;&quot;&quot;</span>
        <span class="n">detections</span> <span class="o">=</span> <span class="p">[</span><span class="n">detections</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u_detection</span><span class="p">]</span>
        <span class="n">dists</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">iou_distance</span><span class="p">(</span><span class="n">unconfirmed</span><span class="p">,</span> <span class="n">detections</span><span class="p">)</span>

        <span class="n">dists</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">fuse_score</span><span class="p">(</span><span class="n">dists</span><span class="p">,</span> <span class="n">detections</span><span class="p">)</span>
        <span class="n">matches</span><span class="p">,</span> <span class="n">u_unconfirmed</span><span class="p">,</span> <span class="n">u_detection</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">linear_assignment</span><span class="p">(</span>
            <span class="n">dists</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mf">0.7</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">itracked</span><span class="p">,</span> <span class="n">idet</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
            <span class="n">unconfirmed</span><span class="p">[</span><span class="n">itracked</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">detections</span><span class="p">[</span><span class="n">idet</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">)</span>
            <span class="n">activated_starcks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unconfirmed</span><span class="p">[</span><span class="n">itracked</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">u_unconfirmed</span><span class="p">:</span>
            <span class="n">track</span> <span class="o">=</span> <span class="n">unconfirmed</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
            <span class="n">track</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Removed</span>
            <span class="n">removed_stracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; Step 4: Init new stracks&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">inew</span> <span class="ow">in</span> <span class="n">u_detection</span><span class="p">:</span>
            <span class="n">track</span> <span class="o">=</span> <span class="n">detections</span><span class="p">[</span><span class="n">inew</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">score</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">det_thresh</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">track</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kalman_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">)</span>
            <span class="n">activated_starcks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Step 5: Update state&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">-</span> <span class="n">track</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_time_lost</span><span class="p">:</span>
                <span class="n">track</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Removed</span>
                <span class="n">removed_stracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span> <span class="o">=</span> <span class="n">joint_tracks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span><span class="p">,</span> <span class="n">activated_starcks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span> <span class="o">=</span> <span class="n">joint_tracks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span><span class="p">,</span> <span class="n">refind_stracks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span> <span class="o">=</span> <span class="n">sub_tracks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lost_stracks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span> <span class="o">=</span> <span class="n">sub_tracks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">removed_tracks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">removed_tracks</span> <span class="o">=</span> <span class="n">removed_stracks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span> <span class="o">=</span> <span class="n">remove_duplicate_tracks</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span>
        <span class="p">)</span>
        <span class="n">output_stracks</span> <span class="o">=</span> <span class="p">[</span><span class="n">track</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span> <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">is_activated</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">output_stracks</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="supertracker.bytetrack.core.ByteTrack.reset" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#supertracker.bytetrack.core.ByteTrack.reset" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Resets the internal state of the ByteTrack tracker.</p>
<p>This method clears the tracking data, including tracked, lost,
and removed tracks, as well as resetting the frame counter. It's
particularly useful when processing multiple videos sequentially,
ensuring the tracker starts with a clean state for each new video.</p>

        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resets the internal state of the ByteTrack tracker.</span>

<span class="sd">    This method clears the tracking data, including tracked, lost,</span>
<span class="sd">    and removed tracks, as well as resetting the frame counter. It&#39;s</span>
<span class="sd">    particularly useful when processing multiple videos sequentially,</span>
<span class="sd">    ensuring the tracker starts with a clean state for each new video.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">internal_id_counter</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">removed_tracks</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="supertracker.bytetrack.core.ByteTrack.update_with_detections" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_with_detections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">detections</span><span class="p">)</span></code>


<a href="#supertracker.bytetrack.core.ByteTrack.update_with_detections" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Updates the tracker with the provided detections and returns the updated
detection results.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>detections</code></td>
        <td><code>Detections</code></td>
        <td><p>The detections to pass through the tracker.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_with_detections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">detections</span><span class="p">:</span> <span class="n">Detections</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Detections</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the tracker with the provided detections and returns the updated</span>
<span class="sd">    detection results.</span>

<span class="sd">    Args:</span>
<span class="sd">        detections (Detections): The detections to pass through the tracker.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tensors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">detections</span><span class="o">.</span><span class="n">xyxy</span><span class="p">,</span>
            <span class="n">detections</span><span class="o">.</span><span class="n">confidence</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">tracks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_with_tensors</span><span class="p">(</span><span class="n">tensors</span><span class="o">=</span><span class="n">tensors</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tracks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">detection_bounding_boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">det</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">det</span> <span class="ow">in</span> <span class="n">tensors</span><span class="p">])</span>
        <span class="n">track_bounding_boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">track</span><span class="o">.</span><span class="n">tlbr</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">tracks</span><span class="p">])</span>

        <span class="n">ious</span> <span class="o">=</span> <span class="n">box_iou_batch</span><span class="p">(</span><span class="n">detection_bounding_boxes</span><span class="p">,</span> <span class="n">track_bounding_boxes</span><span class="p">)</span>

        <span class="n">iou_costs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ious</span>

        <span class="n">matches</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">linear_assignment</span><span class="p">(</span><span class="n">iou_costs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">detections</span><span class="o">.</span><span class="n">tracker_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">detections</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i_detection</span><span class="p">,</span> <span class="n">i_track</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
            <span class="n">detections</span><span class="o">.</span><span class="n">tracker_id</span><span class="p">[</span><span class="n">i_detection</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                <span class="n">tracks</span><span class="p">[</span><span class="n">i_track</span><span class="p">]</span><span class="o">.</span><span class="n">external_track_id</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">detections</span><span class="p">[</span><span class="n">detections</span><span class="o">.</span><span class="n">tracker_id</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">detections</span> <span class="o">=</span> <span class="n">Detections</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>
        <span class="n">detections</span><span class="o">.</span><span class="n">tracker_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">detections</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="supertracker.bytetrack.core.ByteTrack.update_with_tensors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_with_tensors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tensors</span><span class="p">)</span></code>


<a href="#supertracker.bytetrack.core.ByteTrack.update_with_tensors" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Updates the tracker with the provided tensors and returns the updated tracks.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>tensors</code></td>
        <td><code>ndarray</code></td>
        <td><p>The new tensors to update with.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[STrack]</code></td>
      <td><p>Updated tracks.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_with_tensors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tensors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">STrack</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the tracker with the provided tensors and returns the updated tracks.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        tensors: The new tensors to update with.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[STrack]: Updated tracks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">activated_starcks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">refind_stracks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lost_stracks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">removed_stracks</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">scores</span> <span class="o">=</span> <span class="n">tensors</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
    <span class="n">bboxes</span> <span class="o">=</span> <span class="n">tensors</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">4</span><span class="p">]</span>

    <span class="n">remain_inds</span> <span class="o">=</span> <span class="n">scores</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_activation_threshold</span>
    <span class="n">inds_low</span> <span class="o">=</span> <span class="n">scores</span> <span class="o">&gt;</span> <span class="mf">0.1</span>
    <span class="n">inds_high</span> <span class="o">=</span> <span class="n">scores</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_activation_threshold</span>

    <span class="n">inds_second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">inds_low</span><span class="p">,</span> <span class="n">inds_high</span><span class="p">)</span>
    <span class="n">dets_second</span> <span class="o">=</span> <span class="n">bboxes</span><span class="p">[</span><span class="n">inds_second</span><span class="p">]</span>
    <span class="n">dets</span> <span class="o">=</span> <span class="n">bboxes</span><span class="p">[</span><span class="n">remain_inds</span><span class="p">]</span>
    <span class="n">scores_keep</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">remain_inds</span><span class="p">]</span>
    <span class="n">scores_second</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">inds_second</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dets</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detections&quot;&quot;&quot;</span>
        <span class="n">detections</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">STrack</span><span class="p">(</span>
                <span class="n">STrack</span><span class="o">.</span><span class="n">tlbr_to_tlwh</span><span class="p">(</span><span class="n">tlbr</span><span class="p">),</span>
                <span class="n">score_keep</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">minimum_consecutive_frames</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shared_kalman</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">internal_id_counter</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">tlbr</span><span class="p">,</span> <span class="n">score_keep</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dets</span><span class="p">,</span> <span class="n">scores_keep</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">detections</span> <span class="o">=</span> <span class="p">[]</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot; Add newly detected tracklets to tracked_stracks&quot;&quot;&quot;</span>
    <span class="n">unconfirmed</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tracked_stracks</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># type: list[STrack]</span>

    <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">track</span><span class="o">.</span><span class="n">is_activated</span><span class="p">:</span>
            <span class="n">unconfirmed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tracked_stracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot; Step 2: First association, with high score detection boxes&quot;&quot;&quot;</span>
    <span class="n">strack_pool</span> <span class="o">=</span> <span class="n">joint_tracks</span><span class="p">(</span><span class="n">tracked_stracks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span><span class="p">)</span>
    <span class="c1"># Predict the current location with KF</span>
    <span class="n">STrack</span><span class="o">.</span><span class="n">multi_predict</span><span class="p">(</span><span class="n">strack_pool</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_kalman</span><span class="p">)</span>
    <span class="n">dists</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">iou_distance</span><span class="p">(</span><span class="n">strack_pool</span><span class="p">,</span> <span class="n">detections</span><span class="p">)</span>

    <span class="n">dists</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">fuse_score</span><span class="p">(</span><span class="n">dists</span><span class="p">,</span> <span class="n">detections</span><span class="p">)</span>
    <span class="n">matches</span><span class="p">,</span> <span class="n">u_track</span><span class="p">,</span> <span class="n">u_detection</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">linear_assignment</span><span class="p">(</span>
        <span class="n">dists</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minimum_matching_threshold</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">itracked</span><span class="p">,</span> <span class="n">idet</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
        <span class="n">track</span> <span class="o">=</span> <span class="n">strack_pool</span><span class="p">[</span><span class="n">itracked</span><span class="p">]</span>
        <span class="n">det</span> <span class="o">=</span> <span class="n">detections</span><span class="p">[</span><span class="n">idet</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span><span class="p">:</span>
            <span class="n">track</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">detections</span><span class="p">[</span><span class="n">idet</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">)</span>
            <span class="n">activated_starcks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">track</span><span class="o">.</span><span class="n">re_activate</span><span class="p">(</span><span class="n">det</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">)</span>
            <span class="n">refind_stracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot; Step 3: Second association, with low score detection boxes&quot;&quot;&quot;</span>
    <span class="c1"># association the untrack to the low score detections</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dets_second</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detections&quot;&quot;&quot;</span>
        <span class="n">detections_second</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">STrack</span><span class="p">(</span>
                <span class="n">STrack</span><span class="o">.</span><span class="n">tlbr_to_tlwh</span><span class="p">(</span><span class="n">tlbr</span><span class="p">),</span>
                <span class="n">score_second</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">minimum_consecutive_frames</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shared_kalman</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">internal_id_counter</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">tlbr</span><span class="p">,</span> <span class="n">score_second</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dets_second</span><span class="p">,</span> <span class="n">scores_second</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">detections_second</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">r_tracked_stracks</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">strack_pool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u_track</span>
        <span class="k">if</span> <span class="n">strack_pool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span>
    <span class="p">]</span>
    <span class="n">dists</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">iou_distance</span><span class="p">(</span><span class="n">r_tracked_stracks</span><span class="p">,</span> <span class="n">detections_second</span><span class="p">)</span>
    <span class="n">matches</span><span class="p">,</span> <span class="n">u_track</span><span class="p">,</span> <span class="n">u_detection_second</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">linear_assignment</span><span class="p">(</span>
        <span class="n">dists</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mf">0.5</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">itracked</span><span class="p">,</span> <span class="n">idet</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
        <span class="n">track</span> <span class="o">=</span> <span class="n">r_tracked_stracks</span><span class="p">[</span><span class="n">itracked</span><span class="p">]</span>
        <span class="n">det</span> <span class="o">=</span> <span class="n">detections_second</span><span class="p">[</span><span class="n">idet</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span><span class="p">:</span>
            <span class="n">track</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">det</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">)</span>
            <span class="n">activated_starcks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">track</span><span class="o">.</span><span class="n">re_activate</span><span class="p">(</span><span class="n">det</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">)</span>
            <span class="n">refind_stracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">u_track</span><span class="p">:</span>
        <span class="n">track</span> <span class="o">=</span> <span class="n">r_tracked_stracks</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">track</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Lost</span><span class="p">:</span>
            <span class="n">track</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Lost</span>
            <span class="n">lost_stracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deal with unconfirmed tracks, usually tracks with only one beginning frame&quot;&quot;&quot;</span>
    <span class="n">detections</span> <span class="o">=</span> <span class="p">[</span><span class="n">detections</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u_detection</span><span class="p">]</span>
    <span class="n">dists</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">iou_distance</span><span class="p">(</span><span class="n">unconfirmed</span><span class="p">,</span> <span class="n">detections</span><span class="p">)</span>

    <span class="n">dists</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">fuse_score</span><span class="p">(</span><span class="n">dists</span><span class="p">,</span> <span class="n">detections</span><span class="p">)</span>
    <span class="n">matches</span><span class="p">,</span> <span class="n">u_unconfirmed</span><span class="p">,</span> <span class="n">u_detection</span> <span class="o">=</span> <span class="n">matching</span><span class="o">.</span><span class="n">linear_assignment</span><span class="p">(</span>
        <span class="n">dists</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mf">0.7</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">itracked</span><span class="p">,</span> <span class="n">idet</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
        <span class="n">unconfirmed</span><span class="p">[</span><span class="n">itracked</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">detections</span><span class="p">[</span><span class="n">idet</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">)</span>
        <span class="n">activated_starcks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unconfirmed</span><span class="p">[</span><span class="n">itracked</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">u_unconfirmed</span><span class="p">:</span>
        <span class="n">track</span> <span class="o">=</span> <span class="n">unconfirmed</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
        <span class="n">track</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Removed</span>
        <span class="n">removed_stracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot; Step 4: Init new stracks&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">inew</span> <span class="ow">in</span> <span class="n">u_detection</span><span class="p">:</span>
        <span class="n">track</span> <span class="o">=</span> <span class="n">detections</span><span class="p">[</span><span class="n">inew</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">score</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">det_thresh</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">track</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kalman_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">)</span>
        <span class="n">activated_starcks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Step 5: Update state&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">-</span> <span class="n">track</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_time_lost</span><span class="p">:</span>
            <span class="n">track</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Removed</span>
            <span class="n">removed_stracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span>
    <span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span> <span class="o">=</span> <span class="n">joint_tracks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span><span class="p">,</span> <span class="n">activated_starcks</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span> <span class="o">=</span> <span class="n">joint_tracks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span><span class="p">,</span> <span class="n">refind_stracks</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span> <span class="o">=</span> <span class="n">sub_tracks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lost_stracks</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span> <span class="o">=</span> <span class="n">sub_tracks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">removed_tracks</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">removed_tracks</span> <span class="o">=</span> <span class="n">removed_stracks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span> <span class="o">=</span> <span class="n">remove_duplicate_tracks</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lost_tracks</span>
    <span class="p">)</span>
    <span class="n">output_stracks</span> <span class="o">=</span> <span class="p">[</span><span class="n">track</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracked_tracks</span> <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">is_activated</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">output_stracks</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="supertracker.bytetrack.core.joint_tracks" class="doc doc-heading">
<code class="highlight language-python"><span class="n">joint_tracks</span><span class="p">(</span><span class="n">track_list_a</span><span class="p">,</span> <span class="n">track_list_b</span><span class="p">)</span></code>


<a href="#supertracker.bytetrack.core.joint_tracks" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Joins two lists of tracks, ensuring that the resulting list does not
contain tracks with duplicate internal_track_id values.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>track_list_a</code></td>
        <td><code>List[supertracker.bytetrack.single_object_track.STrack]</code></td>
        <td><p>First list of tracks (with internal_track_id attribute).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>track_list_b</code></td>
        <td><code>List[supertracker.bytetrack.single_object_track.STrack]</code></td>
        <td><p>Second list of tracks (with internal_track_id attribute).</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[supertracker.bytetrack.single_object_track.STrack]</code></td>
      <td><p>Combined list of tracks from track_list_a and track_list_b
    without duplicate internal_track_id values.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">joint_tracks</span><span class="p">(</span>
    <span class="n">track_list_a</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">STrack</span><span class="p">],</span> <span class="n">track_list_b</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">STrack</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">STrack</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Joins two lists of tracks, ensuring that the resulting list does not</span>
<span class="sd">    contain tracks with duplicate internal_track_id values.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        track_list_a: First list of tracks (with internal_track_id attribute).</span>
<span class="sd">        track_list_b: Second list of tracks (with internal_track_id attribute).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Combined list of tracks from track_list_a and track_list_b</span>
<span class="sd">            without duplicate internal_track_id values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">seen_track_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">track_list_a</span> <span class="o">+</span> <span class="n">track_list_b</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">internal_track_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen_track_ids</span><span class="p">:</span>
            <span class="n">seen_track_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">track</span><span class="o">.</span><span class="n">internal_track_id</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="supertracker.bytetrack.core.sub_tracks" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sub_tracks</span><span class="p">(</span><span class="n">track_list_a</span><span class="p">,</span> <span class="n">track_list_b</span><span class="p">)</span></code>


<a href="#supertracker.bytetrack.core.sub_tracks" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns a list of tracks from track_list_a after removing any tracks
that share the same internal_track_id with tracks in track_list_b.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>track_list_a</code></td>
        <td><code>List[supertracker.bytetrack.single_object_track.STrack]</code></td>
        <td><p>List of tracks (with internal_track_id attribute).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>track_list_b</code></td>
        <td><code>List[supertracker.bytetrack.single_object_track.STrack]</code></td>
        <td><p>List of tracks (with internal_track_id attribute) to
be subtracted from track_list_a.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[int]</code></td>
      <td><p>List of remaining tracks from track_list_a after subtraction.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sub_tracks</span><span class="p">(</span><span class="n">track_list_a</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">STrack</span><span class="p">],</span> <span class="n">track_list_b</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">STrack</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of tracks from track_list_a after removing any tracks</span>
<span class="sd">    that share the same internal_track_id with tracks in track_list_b.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        track_list_a: List of tracks (with internal_track_id attribute).</span>
<span class="sd">        track_list_b: List of tracks (with internal_track_id attribute) to</span>
<span class="sd">            be subtracted from track_list_a.</span>
<span class="sd">    Returns:</span>
<span class="sd">        List of remaining tracks from track_list_a after subtraction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tracks</span> <span class="o">=</span> <span class="p">{</span><span class="n">track</span><span class="o">.</span><span class="n">internal_track_id</span><span class="p">:</span> <span class="n">track</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">track_list_a</span><span class="p">}</span>
    <span class="n">track_ids_b</span> <span class="o">=</span> <span class="p">{</span><span class="n">track</span><span class="o">.</span><span class="n">internal_track_id</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">track_list_b</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">track_id</span> <span class="ow">in</span> <span class="n">track_ids_b</span><span class="p">:</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">tracks</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="supertracker.bytetrack.kalman_filter" class="doc doc-heading">
        <code>kalman_filter</code>



<a href="#supertracker.bytetrack.kalman_filter" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="supertracker.bytetrack.kalman_filter.KalmanFilter" class="doc doc-heading">
        <code>
KalmanFilter        </code>



<a href="#supertracker.bytetrack.kalman_filter.KalmanFilter" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>A simple Kalman filter for tracking bounding boxes in image space.</p>
<p>The 8-dimensional state space</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>x, y, a, h, vx, vy, va, vh
</code></pre></div></td></tr></table></div>
<p>contains the bounding box center position (x, y), aspect ratio a, height h,
and their respective velocities.</p>
<p>Object motion follows a constant velocity model. The bounding box location
(x, y, a, h) is taken as direct observation of the state space (linear
observation model).</p>

        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/kalman_filter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">KalmanFilter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A simple Kalman filter for tracking bounding boxes in image space.</span>

<span class="sd">    The 8-dimensional state space</span>

<span class="sd">        x, y, a, h, vx, vy, va, vh</span>

<span class="sd">    contains the bounding box center position (x, y), aspect ratio a, height h,</span>
<span class="sd">    and their respective velocities.</span>

<span class="sd">    Object motion follows a constant velocity model. The bounding box location</span>
<span class="sd">    (x, y, a, h) is taken as direct observation of the state space (linear</span>
<span class="sd">    observation model).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ndim</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ndim</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ndim</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ndim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mi">20</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mi">160</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">initiate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measurement</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create track from an unassociated measurement.</span>

<span class="sd">        Args:</span>
<span class="sd">            measurement (ndarray): Bounding box coordinates (x, y, a, h) with</span>
<span class="sd">                center position (x, y), aspect ratio a, and height h.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[ndarray, ndarray]: Returns the mean vector (8 dimensional) and</span>
<span class="sd">                covariance matrix (8x8 dimensional) of the new track.</span>
<span class="sd">                Unobserved velocities are initialized to 0 mean.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mean_pos</span> <span class="o">=</span> <span class="n">measurement</span>
        <span class="n">mean_vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">mean_pos</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">mean_pos</span><span class="p">,</span> <span class="n">mean_vel</span><span class="p">]</span>

        <span class="n">std</span> <span class="o">=</span> <span class="p">[</span>
            <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="mf">1e-2</span><span class="p">,</span>
            <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="mf">1e-5</span><span class="p">,</span>
            <span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">std</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run Kalman filter prediction step.</span>

<span class="sd">        Args:</span>
<span class="sd">            mean (ndarray): The 8 dimensional mean vector of the object</span>
<span class="sd">                state at the previous time step.</span>
<span class="sd">            covariance (ndarray): The 8x8 dimensional covariance matrix of</span>
<span class="sd">                the object state at the previous time step.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[ndarray, ndarray]: Returns the mean vector and</span>
<span class="sd">                covariance matrix of the predicted state.</span>
<span class="sd">                Unobserved velocities are initialized to 0 mean.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">std_pos</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="mf">1e-2</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="n">std_vel</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="mf">1e-5</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="n">motion_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">std_pos</span><span class="p">,</span> <span class="n">std_vel</span><span class="p">]))</span>

        <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="n">covariance</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
            <span class="o">+</span> <span class="n">motion_cov</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">project</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Project state distribution to measurement space.</span>

<span class="sd">        Args:</span>
<span class="sd">            mean (ndarray): The state&#39;s mean vector (8 dimensional array).</span>
<span class="sd">            covariance (ndarray): The state&#39;s covariance matrix (8x8 dimensional).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[ndarray, ndarray]: Returns the projected mean and</span>
<span class="sd">                covariance matrix of the given state estimate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">std</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="mf">1e-1</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="n">innovation_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">std</span><span class="p">))</span>

        <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
        <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span> <span class="o">+</span> <span class="n">innovation_cov</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">multi_predict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run Kalman filter prediction step (Vectorized version).</span>

<span class="sd">        Args:</span>
<span class="sd">            mean (ndarray): The Nx8 dimensional mean matrix</span>
<span class="sd">                of the object states at the previous time step.</span>
<span class="sd">            covariance (ndarray): The Nx8x8 dimensional covariance matrices</span>
<span class="sd">                of the object states at the previous time step.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[ndarray, ndarray]: Returns the mean vector and</span>
<span class="sd">                covariance matrix of the predicted state.</span>
<span class="sd">                Unobserved velocities are initialized to 0 mean.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">std_pos</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="mf">1e-2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="n">std_vel</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="mf">1e-5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="n">sqr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">std_pos</span><span class="p">,</span> <span class="n">std_vel</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

        <span class="n">motion_cov</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mean</span><span class="p">)):</span>
            <span class="n">motion_cov</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">sqr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">motion_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">motion_cov</span><span class="p">)</span>

        <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">motion_cov</span>

        <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">measurement</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run Kalman filter correction step.</span>

<span class="sd">        Args:</span>
<span class="sd">            mean (ndarray): The predicted state&#39;s mean vector (8 dimensional).</span>
<span class="sd">            covariance (ndarray): The state&#39;s covariance matrix (8x8 dimensional).</span>
<span class="sd">            measurement (ndarray): The 4-dimensional measurement vector (x, y, a, h),</span>
<span class="sd">                where (x, y) is the center position, a the aspect ratio,</span>
<span class="sd">                and h the height of the bounding box.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[ndarray, ndarray]: Returns the measurement-corrected</span>
<span class="sd">                state distribution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">projected_mean</span><span class="p">,</span> <span class="n">projected_cov</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span>

        <span class="n">chol_factor</span><span class="p">,</span> <span class="n">lower</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cho_factor</span><span class="p">(</span>
            <span class="n">projected_cov</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">kalman_gain</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cho_solve</span><span class="p">(</span>
            <span class="p">(</span><span class="n">chol_factor</span><span class="p">,</span> <span class="n">lower</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
            <span class="n">check_finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">innovation</span> <span class="o">=</span> <span class="n">measurement</span> <span class="o">-</span> <span class="n">projected_mean</span>

        <span class="n">new_mean</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">innovation</span><span class="p">,</span> <span class="n">kalman_gain</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="n">new_covariance</span> <span class="o">=</span> <span class="n">covariance</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">(</span>
            <span class="p">(</span><span class="n">kalman_gain</span><span class="p">,</span> <span class="n">projected_cov</span><span class="p">,</span> <span class="n">kalman_gain</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">new_mean</span><span class="p">,</span> <span class="n">new_covariance</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="supertracker.bytetrack.kalman_filter.KalmanFilter.initiate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">initiate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measurement</span><span class="p">)</span></code>


<a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.initiate" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Create track from an unassociated measurement.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>measurement</code></td>
        <td><code>ndarray</code></td>
        <td><p>Bounding box coordinates (x, y, a, h) with
center position (x, y), aspect ratio a, and height h.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[ndarray, ndarray]</code></td>
      <td><p>Returns the mean vector (8 dimensional) and
    covariance matrix (8x8 dimensional) of the new track.
    Unobserved velocities are initialized to 0 mean.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/kalman_filter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">initiate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measurement</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create track from an unassociated measurement.</span>

<span class="sd">    Args:</span>
<span class="sd">        measurement (ndarray): Bounding box coordinates (x, y, a, h) with</span>
<span class="sd">            center position (x, y), aspect ratio a, and height h.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[ndarray, ndarray]: Returns the mean vector (8 dimensional) and</span>
<span class="sd">            covariance matrix (8x8 dimensional) of the new track.</span>
<span class="sd">            Unobserved velocities are initialized to 0 mean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mean_pos</span> <span class="o">=</span> <span class="n">measurement</span>
    <span class="n">mean_vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">mean_pos</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">mean_pos</span><span class="p">,</span> <span class="n">mean_vel</span><span class="p">]</span>

    <span class="n">std</span> <span class="o">=</span> <span class="p">[</span>
        <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="mf">1e-2</span><span class="p">,</span>
        <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="mf">1e-5</span><span class="p">,</span>
        <span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
    <span class="p">]</span>
    <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">std</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="supertracker.bytetrack.kalman_filter.KalmanFilter.multi_predict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">multi_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span></code>


<a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.multi_predict" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Run Kalman filter prediction step (Vectorized version).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mean</code></td>
        <td><code>ndarray</code></td>
        <td><p>The Nx8 dimensional mean matrix
of the object states at the previous time step.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>covariance</code></td>
        <td><code>ndarray</code></td>
        <td><p>The Nx8x8 dimensional covariance matrices
of the object states at the previous time step.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[ndarray, ndarray]</code></td>
      <td><p>Returns the mean vector and
    covariance matrix of the predicted state.
    Unobserved velocities are initialized to 0 mean.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/kalman_filter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">multi_predict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run Kalman filter prediction step (Vectorized version).</span>

<span class="sd">    Args:</span>
<span class="sd">        mean (ndarray): The Nx8 dimensional mean matrix</span>
<span class="sd">            of the object states at the previous time step.</span>
<span class="sd">        covariance (ndarray): The Nx8x8 dimensional covariance matrices</span>
<span class="sd">            of the object states at the previous time step.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[ndarray, ndarray]: Returns the mean vector and</span>
<span class="sd">            covariance matrix of the predicted state.</span>
<span class="sd">            Unobserved velocities are initialized to 0 mean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">std_pos</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="mf">1e-2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">]</span>
    <span class="n">std_vel</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="mf">1e-5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">]</span>
    <span class="n">sqr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">std_pos</span><span class="p">,</span> <span class="n">std_vel</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

    <span class="n">motion_cov</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mean</span><span class="p">)):</span>
        <span class="n">motion_cov</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">sqr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">motion_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">motion_cov</span><span class="p">)</span>

    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">motion_cov</span>

    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="supertracker.bytetrack.kalman_filter.KalmanFilter.predict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span></code>


<a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.predict" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Run Kalman filter prediction step.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mean</code></td>
        <td><code>ndarray</code></td>
        <td><p>The 8 dimensional mean vector of the object
state at the previous time step.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>covariance</code></td>
        <td><code>ndarray</code></td>
        <td><p>The 8x8 dimensional covariance matrix of
the object state at the previous time step.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[ndarray, ndarray]</code></td>
      <td><p>Returns the mean vector and
    covariance matrix of the predicted state.
    Unobserved velocities are initialized to 0 mean.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/kalman_filter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run Kalman filter prediction step.</span>

<span class="sd">    Args:</span>
<span class="sd">        mean (ndarray): The 8 dimensional mean vector of the object</span>
<span class="sd">            state at the previous time step.</span>
<span class="sd">        covariance (ndarray): The 8x8 dimensional covariance matrix of</span>
<span class="sd">            the object state at the previous time step.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[ndarray, ndarray]: Returns the mean vector and</span>
<span class="sd">            covariance matrix of the predicted state.</span>
<span class="sd">            Unobserved velocities are initialized to 0 mean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">std_pos</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="mf">1e-2</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
    <span class="p">]</span>
    <span class="n">std_vel</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="mf">1e-5</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
    <span class="p">]</span>
    <span class="n">motion_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">std_pos</span><span class="p">,</span> <span class="n">std_vel</span><span class="p">]))</span>

    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">covariance</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
        <span class="o">+</span> <span class="n">motion_cov</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="supertracker.bytetrack.kalman_filter.KalmanFilter.project" class="doc doc-heading">
<code class="highlight language-python"><span class="n">project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span></code>


<a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.project" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Project state distribution to measurement space.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mean</code></td>
        <td><code>ndarray</code></td>
        <td><p>The state's mean vector (8 dimensional array).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>covariance</code></td>
        <td><code>ndarray</code></td>
        <td><p>The state's covariance matrix (8x8 dimensional).</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[ndarray, ndarray]</code></td>
      <td><p>Returns the projected mean and
    covariance matrix of the given state estimate.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/kalman_filter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">project</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Project state distribution to measurement space.</span>

<span class="sd">    Args:</span>
<span class="sd">        mean (ndarray): The state&#39;s mean vector (8 dimensional array).</span>
<span class="sd">        covariance (ndarray): The state&#39;s covariance matrix (8x8 dimensional).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[ndarray, ndarray]: Returns the projected mean and</span>
<span class="sd">            covariance matrix of the given state estimate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">std</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="mf">1e-1</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
    <span class="p">]</span>
    <span class="n">innovation_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">std</span><span class="p">))</span>

    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
    <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">(</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span> <span class="o">+</span> <span class="n">innovation_cov</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="supertracker.bytetrack.kalman_filter.KalmanFilter.update" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="n">measurement</span><span class="p">)</span></code>


<a href="#supertracker.bytetrack.kalman_filter.KalmanFilter.update" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Run Kalman filter correction step.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mean</code></td>
        <td><code>ndarray</code></td>
        <td><p>The predicted state's mean vector (8 dimensional).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>covariance</code></td>
        <td><code>ndarray</code></td>
        <td><p>The state's covariance matrix (8x8 dimensional).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>measurement</code></td>
        <td><code>ndarray</code></td>
        <td><p>The 4-dimensional measurement vector (x, y, a, h),
where (x, y) is the center position, a the aspect ratio,
and h the height of the bounding box.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[ndarray, ndarray]</code></td>
      <td><p>Returns the measurement-corrected
    state distribution.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/kalman_filter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">measurement</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run Kalman filter correction step.</span>

<span class="sd">    Args:</span>
<span class="sd">        mean (ndarray): The predicted state&#39;s mean vector (8 dimensional).</span>
<span class="sd">        covariance (ndarray): The state&#39;s covariance matrix (8x8 dimensional).</span>
<span class="sd">        measurement (ndarray): The 4-dimensional measurement vector (x, y, a, h),</span>
<span class="sd">            where (x, y) is the center position, a the aspect ratio,</span>
<span class="sd">            and h the height of the bounding box.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[ndarray, ndarray]: Returns the measurement-corrected</span>
<span class="sd">            state distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">projected_mean</span><span class="p">,</span> <span class="n">projected_cov</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span>

    <span class="n">chol_factor</span><span class="p">,</span> <span class="n">lower</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cho_factor</span><span class="p">(</span>
        <span class="n">projected_cov</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">kalman_gain</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cho_solve</span><span class="p">(</span>
        <span class="p">(</span><span class="n">chol_factor</span><span class="p">,</span> <span class="n">lower</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
        <span class="n">check_finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">innovation</span> <span class="o">=</span> <span class="n">measurement</span> <span class="o">-</span> <span class="n">projected_mean</span>

    <span class="n">new_mean</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">innovation</span><span class="p">,</span> <span class="n">kalman_gain</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">new_covariance</span> <span class="o">=</span> <span class="n">covariance</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">(</span>
        <span class="p">(</span><span class="n">kalman_gain</span><span class="p">,</span> <span class="n">projected_cov</span><span class="p">,</span> <span class="n">kalman_gain</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">new_mean</span><span class="p">,</span> <span class="n">new_covariance</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>




  <div class="doc doc-object doc-module">



<h2 id="supertracker.bytetrack.single_object_track" class="doc doc-heading">
        <code>single_object_track</code>



<a href="#supertracker.bytetrack.single_object_track" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="supertracker.bytetrack.single_object_track.STrack" class="doc doc-heading">
        <code>
STrack        </code>



<a href="#supertracker.bytetrack.single_object_track.STrack" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/single_object_track.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">STrack</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tlwh</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">],</span>
        <span class="n">score</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">],</span>
        <span class="n">minimum_consecutive_frames</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">shared_kalman</span><span class="p">:</span> <span class="n">KalmanFilter</span><span class="p">,</span>
        <span class="n">internal_id_counter</span><span class="p">:</span> <span class="n">IdCounter</span><span class="p">,</span>
        <span class="n">external_id_counter</span><span class="p">:</span> <span class="n">IdCounter</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">New</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_activated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_tlwh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tlwh</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kalman_filter</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared_kalman</span> <span class="o">=</span> <span class="n">shared_kalman</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_activated</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">score</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracklet_len</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minimum_consecutive_frames</span> <span class="o">=</span> <span class="n">minimum_consecutive_frames</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">internal_id_counter</span> <span class="o">=</span> <span class="n">internal_id_counter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span> <span class="o">=</span> <span class="n">external_id_counter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">internal_track_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_id_counter</span><span class="o">.</span><span class="n">NO_ID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_track_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span><span class="o">.</span><span class="n">NO_ID</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mean_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">!=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span><span class="p">:</span>
            <span class="n">mean_state</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kalman_filter</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
            <span class="n">mean_state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">multi_predict</span><span class="p">(</span><span class="n">stracks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">STrack</span><span class="p">],</span> <span class="n">shared_kalman</span><span class="p">:</span> <span class="n">KalmanFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stracks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">multi_mean</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">multi_covariance</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">st</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stracks</span><span class="p">):</span>
                <span class="n">multi_mean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
                <span class="n">multi_covariance</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">covariance</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">state</span> <span class="o">!=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span><span class="p">:</span>
                    <span class="n">multi_mean</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">multi_mean</span><span class="p">,</span> <span class="n">multi_covariance</span> <span class="o">=</span> <span class="n">shared_kalman</span><span class="o">.</span><span class="n">multi_predict</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">multi_mean</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">multi_covariance</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">cov</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">multi_mean</span><span class="p">,</span> <span class="n">multi_covariance</span><span class="p">)):</span>
                <span class="n">stracks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">mean</span>
                <span class="n">stracks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">cov</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kalman_filter</span><span class="p">:</span> <span class="n">KalmanFilter</span><span class="p">,</span> <span class="n">frame_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start a new tracklet&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kalman_filter</span> <span class="o">=</span> <span class="n">kalman_filter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">internal_track_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_id_counter</span><span class="o">.</span><span class="n">new_id</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kalman_filter</span><span class="o">.</span><span class="n">initiate</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tlwh_to_xyah</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tlwh</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tracklet_len</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span>
        <span class="k">if</span> <span class="n">frame_id</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_activated</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_consecutive_frames</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">external_track_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span><span class="o">.</span><span class="n">new_id</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="n">frame_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span> <span class="o">=</span> <span class="n">frame_id</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">re_activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_track</span><span class="p">:</span> <span class="n">STrack</span><span class="p">,</span> <span class="n">frame_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kalman_filter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tlwh_to_xyah</span><span class="p">(</span><span class="n">new_track</span><span class="o">.</span><span class="n">tlwh</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracklet_len</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="n">frame_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">new_track</span><span class="o">.</span><span class="n">score</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_track</span><span class="p">:</span> <span class="n">STrack</span><span class="p">,</span> <span class="n">frame_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update a matched track</span>
<span class="sd">        :type new_track: STrack</span>
<span class="sd">        :type frame_id: int</span>
<span class="sd">        :type update_feature: bool</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="n">frame_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracklet_len</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">new_tlwh</span> <span class="o">=</span> <span class="n">new_track</span><span class="o">.</span><span class="n">tlwh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kalman_filter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tlwh_to_xyah</span><span class="p">(</span><span class="n">new_tlwh</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracklet_len</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_consecutive_frames</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_activated</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_track_id</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span><span class="o">.</span><span class="n">NO_ID</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">external_track_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span><span class="o">.</span><span class="n">new_id</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">new_track</span><span class="o">.</span><span class="n">score</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tlwh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current position in bounding box format `(top left x, top left y,</span>
<span class="sd">        width, height)`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tlwh</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">ret</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="n">ret</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">ret</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">ret</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tlbr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert bounding box to format `(min x, min y, max x, max y)`, i.e.,</span>
<span class="sd">        `(top left, bottom right)`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tlwh</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">ret</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">ret</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tlwh_to_xyah</span><span class="p">(</span><span class="n">tlwh</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert bounding box to format `(center x, center y, aspect ratio,</span>
<span class="sd">        height)`, where the aspect ratio is `width / height`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tlwh</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">ret</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ret</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">ret</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/=</span> <span class="n">ret</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_xyah</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tlwh_to_xyah</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tlwh</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tlbr_to_tlwh</span><span class="p">(</span><span class="n">tlbr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tlbr</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">ret</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">ret</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tlwh_to_tlbr</span><span class="p">(</span><span class="n">tlwh</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tlwh</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">ret</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">ret</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;OT_</span><span class="si">{}</span><span class="s2">_(</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">internal_track_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 id="supertracker.bytetrack.single_object_track.STrack.tlbr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">tlbr</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#supertracker.bytetrack.single_object_track.STrack.tlbr" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Convert bounding box to format <code>(min x, min y, max x, max y)</code>, i.e.,
<code>(top left, bottom right)</code>.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="supertracker.bytetrack.single_object_track.STrack.tlwh" class="doc doc-heading">
<code class="highlight language-python"><span class="n">tlwh</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#supertracker.bytetrack.single_object_track.STrack.tlwh" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Get current position in bounding box format <code>(top left x, top left y,
width, height)</code>.</p>
    </div>

  </div>








  <div class="doc doc-object doc-method">



<h4 id="supertracker.bytetrack.single_object_track.STrack.activate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kalman_filter</span><span class="p">,</span> <span class="n">frame_id</span><span class="p">)</span></code>


<a href="#supertracker.bytetrack.single_object_track.STrack.activate" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Start a new tracklet</p>

        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/single_object_track.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kalman_filter</span><span class="p">:</span> <span class="n">KalmanFilter</span><span class="p">,</span> <span class="n">frame_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start a new tracklet&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kalman_filter</span> <span class="o">=</span> <span class="n">kalman_filter</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">internal_track_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_id_counter</span><span class="o">.</span><span class="n">new_id</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kalman_filter</span><span class="o">.</span><span class="n">initiate</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlwh_to_xyah</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tlwh</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">tracklet_len</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span>
    <span class="k">if</span> <span class="n">frame_id</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_activated</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_consecutive_frames</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_track_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span><span class="o">.</span><span class="n">new_id</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="n">frame_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span> <span class="o">=</span> <span class="n">frame_id</span>
</code></pre></div>
        </details>
    </div>

  </div>








  <div class="doc doc-object doc-method">



<h4 id="supertracker.bytetrack.single_object_track.STrack.tlwh_to_xyah" class="doc doc-heading">
<code class="highlight language-python"><span class="n">tlwh_to_xyah</span><span class="p">(</span><span class="n">tlwh</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#supertracker.bytetrack.single_object_track.STrack.tlwh_to_xyah" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Convert bounding box to format <code>(center x, center y, aspect ratio,
height)</code>, where the aspect ratio is <code>width / height</code>.</p>

        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/single_object_track.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">tlwh_to_xyah</span><span class="p">(</span><span class="n">tlwh</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert bounding box to format `(center x, center y, aspect ratio,</span>
<span class="sd">    height)`, where the aspect ratio is `width / height`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tlwh</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ret</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ret</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">ret</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/=</span> <span class="n">ret</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h4 id="supertracker.bytetrack.single_object_track.STrack.update" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_track</span><span class="p">,</span> <span class="n">frame_id</span><span class="p">)</span></code>


<a href="#supertracker.bytetrack.single_object_track.STrack.update" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Update a matched track
:type new_track: STrack
:type frame_id: int
:type update_feature: bool
:return:</p>

        <details class="quote">
          <summary>Source code in <code>supertracker/bytetrack/single_object_track.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_track</span><span class="p">:</span> <span class="n">STrack</span><span class="p">,</span> <span class="n">frame_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update a matched track</span>
<span class="sd">    :type new_track: STrack</span>
<span class="sd">    :type frame_id: int</span>
<span class="sd">    :type update_feature: bool</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="n">frame_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tracklet_len</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">new_tlwh</span> <span class="o">=</span> <span class="n">new_track</span><span class="o">.</span><span class="n">tlwh</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kalman_filter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tlwh_to_xyah</span><span class="p">(</span><span class="n">new_tlwh</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">TrackState</span><span class="o">.</span><span class="n">Tracked</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracklet_len</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_consecutive_frames</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_activated</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_track_id</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span><span class="o">.</span><span class="n">NO_ID</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">external_track_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_id_counter</span><span class="o">.</span><span class="n">new_id</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">new_track</span><span class="o">.</span><span class="n">score</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>








  </div>

    </div>

  </div>





  </div>

    </div>

  </div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-02-06T19:05:49+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-02-06</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-02-06T18:40:42+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-02-06</span>
  </span>

    
    
    
  </aside>





                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 - 2024 Hirai Labs
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.top", "search.highlight", "search.share"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../js/timeago.min.js"></script>
      
        <script src="../js/timeago_mkdocs_material.js"></script>
      
    
  </body>
</html>